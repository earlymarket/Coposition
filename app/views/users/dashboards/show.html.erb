<%= Gon::Base.render_data %>
<section class="dashboard row">
  <h4>Hello <%= current_user.username %></h4>
  <p>
    You checked-in <%= @presenter.weeks_checkins_count || 0 %> times this week.
    <% if @presenter.percent_change.present? %>
      <br />
      That is an <%= @presenter.percent_change > 0 ? 'increase' : 'decrease' %> of <%= @presenter.percent_change %>% from last week.
    <% end %>

     <% if @presenter.most_used_device.present? %>
        Your most used device is <%= @presenter.most_used_device.name %>.
    <% end %>
  </p>
</section>

<section class="dashboard row">
  <div class="col s12">
    <div id="map"></div>
  </div>
</section>

<div class="divider"></div>

<section id="dashboard-charts" class="dashboard row">
  <article class="chart col s12 l6" id='weeks-checkins'>
    <h5>This weeks check-ins</h5>
    <div id='bar-chart'></div>
  </article>
  <article class="col s12 l6" id="most-checkins">
    <ul class="collection">
      <li class="collection-header"><h5>Most frequent check-in location</h5></li>
      <% @presenter.most_frequent_areas.each do |area_count| %>
        <li class="collection-item"><div><%= area_count[0] %><span class="badge"><%= area_count[1] %> check-ins</span></div></li>
      <% end if @presenter.most_frequent_areas.present? %>
    </ul>
  </article>
</section>

<div class="divider"></div>

<section id="dashboard-quicklinks">
  <p class='center'>
    You have <%= pluralize(current_user.devices.count, 'device') %>, <%= pluralize(current_user.developers.count, 'app') %> and <%= pluralize(current_user.friends.count, 'friend') %>.
     You have <%= link_to(pluralize(current_user.developer_requests.count, 'app'), user_apps_path) %> and
    <%= link_to(pluralize(current_user.friend_requests.count, 'friend'), user_friends_path) %> awaiting your approval.
  </p>
</section>
